
# Default password (change if needed)
$defaultPassword = "Sierra0001"

# Convert to secure string
$securePass = ConvertTo-SecureString $defaultPassword -AsPlainText -Force

# User data (imported from Excel)
$users = @(
    @{
        Username="Administrator";
        Status="Enabled";
        Groups="Administrators, Domain Admins, Enterprise Admins, Group Policy Creator Owners, Schema Admin"
    },
    @{
        Username="Student";
        Status="Enabled";
        Groups="Administrators, Domain Admins, Enterprise Admins"
    },
    @{
        Username="hulk";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="loki";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="ironman";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="helena.aeriel";
        Status="Enabled";
        Groups="sales, Senior Management"
    },
    @{
        Username="brianne.Amelia";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="jacquelynn.lilli";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="lemar.gabriel";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="clara.eugenie";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="lilla.perrine";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="emlynne.bess";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="melony.korry";
        Status="Enabled";
        Groups="marketing"
    },
    @{
        Username="evvie.ardis";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="coletta.corette";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="madella.catharina";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="odelinda.selina";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="corrina.arleen";
        Status="Enabled";
        Groups="accounting"
    },
    @{
        Username="ariele.glenna";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="melinde.ealasaid";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="daniela.bebe";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="rakel.faustina";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="starlene.cristal";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="brooke.lelia";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="pam.evangelia";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="hatty.gilberta";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="samaria.elga";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="fleur.emma";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="kristel.moyra";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="rebecka.karna";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="shaina.kurtis";
        Status="Enabled";
        Groups="Marketing"
    },
    @{
        Username="karylin.nelle";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="gloriane.nonie";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="beatrix.magdalen";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="eloise.diahann";
        Status="Enabled";
        Groups="sales"
    },
    @{
        Username="clari.miof mela";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="stephannie.staci";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="polly.perry";
        Status="Enabled";
        Groups="accounting"
    },
    @{
        Username="lauretta.henryetta";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="constanta.kay";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="janith.sonya";
        Status="Enabled";
        Groups="Senior management"
    },
    @{
        Username="anya.katya";
        Status="Enabled";
        Groups="DnsAdmins, Executives"
    },
    @{
        Username="denise.kristina";
        Status="Enabled";
        Groups="Project management"
    },
    @{
        Username="harmonie.kristy";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="stephanie.sunny";
        Status="Enabled";
        Groups="DnsAdmins"
    },
    @{
        Username="ardys.esmeralda";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="leese.emilee";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="gloria.cristi";
        Status="Enabled";
        Groups="accounting"
    },
    @{
        Username="luca.lizzie";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="berrie.kipper";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="jayme.halimeda";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="latrena.jo-anne";
        Status="Enabled";
        Groups="accounting"
    },
    @{
        Username="ophelia.prue";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="joya.rheba";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="blinni.hedda";
        Status="Enabled";
        Groups="accounting"
    },
    @{
        Username="selle.shirl";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="linnie.kaela";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="melanie.lars";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="lorry.bryana";
        Status="Enabled";
        Groups="sales"
    },
    @{
        Username="gizela.leia";
        Status="Enabled";
        Groups="Office Admin"
    },
    @{
        Username="harriott.hattie";
        Status="Enabled";
        Groups="Senior management"
    },
    @{
        Username="nessa.lenora";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="gwennie.antonetta";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="gilberte.annabella";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="anjela.renata";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="lacey.eugenie";
        Status="Enabled";
        Groups="DnsAdmins"
    },
    @{
        Username="alvina.dania";
        Status="Enabled";
        Groups="Executives, Senior management"
    },
    @{
        Username="katharina.amelie";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="anissa.allyce";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="malva.sheba";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="mariette.alice";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="ermentrude.izabel";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="octavia.shantee";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="hilary.philis";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="ettie.hettie";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="sophie.beverly";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="cinderella.kassie";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="calley.glynda";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="sheelagh.adoree";
        Status="Enabled";
        Groups="Office Admin"
    },
    @{
        Username="dotti.larina";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="berta.annaliese";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="audy.dido";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="martha.anthea";
        Status="Enabled";
        Groups="accounting"
    },
    @{
        Username="daphna.jeannette";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="kip.marcelle";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="regan.bea";
        Status="Enabled";
        Groups="sales"
    },
    @{
        Username="sophie.alisha";
        Status="Enabled";
        Groups="IT Admins"
    },
    @{
        Username="adan.joana";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="opaline.lorene";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="nicoline.lizbeth";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="pamela.isis";
        Status="Enabled";
        Groups="accounting"
    },
    @{
        Username="aubrette.maegan";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="daryn.cynthia";
        Status="Enabled";
        Groups="accounting"
    },
    @{
        Username="sophronia.rori";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="olimpia.gwenore";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="amandi.kerrin";
        Status="Enabled";
        Groups="none"
    },
    @{
        Username="dinah.myrtia";
        Status="Enabled";
        Groups="none"
    }
)

foreach ($user in $users) {
    try {
        # Clean username (replace dots with underscores)
        $safeUsername = $user.Username -replace '\.', '_'

        # Create user (enabled by default)
        New-LocalUser -Name $safeUsername -Password $securePass -FullName $user.Username -Description "Cyber Challenge User" -AccountNeverExpires
        Write-Host "Created user:" $safeUsername

        # Add to groups
        if ($user.Groups -ne "" -and $user.Groups -ne $null -and $user.Groups -ne "none") {
            $groupList = $user.Groups -split ","
            foreach ($group in $groupList) {
                $trimmedGroup = $group.Trim()
                if ($trimmedGroup -ne "") {
                    Add-LocalGroupMember -Group $trimmedGroup -Member $safeUsername -ErrorAction SilentlyContinue
                    Write-Host " -> Added to group:" $trimmedGroup
                }
            }
        }
    } catch {
        Write-Host "[ERROR] $($user.Username): $($_.Exception.Message)"
    }
}
